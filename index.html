<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="applicable-device" content="mobile" />
    <meta name="referrer" content="always" />
    <meta
      name="viewport"
      content="width=device-width, height=device-height, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"
    />
    <title>不靠谱医院活动</title>
    <link rel="stylesheet" type="text/css" href="./reset.css" />
    <script src="./data.js"></script>
    <style>
      #app {
        width: 100%;
        overflow: hidden;
        height: 100%;
        /* background: #e4f1ff; */
        background-image: url("./images/background1.jpg");
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;
        position: relative;
      }
      input {
        border: 1px solid red;
        line-height: 2rem;
        border-radius: 1rem;
        text-align: center;
      }
      .first-page {
        margin-top: 128%;
        padding: 0 27.3%;
        display: block;
      }
      .first-page-input {
        width: 100%;
        display: block;
        border: 0.2rem solid #50352b;
        line-height: 3.4rem;
        border-radius: 2.2rem;
        text-align: center;
        font-size: 1.3rem;
        color: #999999;
        outline: none;
      }
      .first-page-button {
        width: 100%;
        display: block;
        margin-top: 2rem;
        height: auto;
      }
      .second-page {
        width: 62.1%;
        margin: 35% auto 0;
        font-size: 1.6rem;
        color: #333333;
        display: block;
        font-weight: 500;
      }
      .second-page-title {
        margin-bottom: 1.35rem;
      }
      .content-img,
      .content-tip,
      .icon-circle,
      .icon-circle_checked {
        display: inline-block;
        vertical-align: middle;
      }
      .content-img {
        width: 1.6rem;
        height: auto;
        display: inline-block;
        margin-right: 0.2rem;
      }
      .second-page-content {
        margin-top: 1.5rem;
      }
      .three-page {
        widows: 100%;
        height: 100%;
        display: none;
      }
      .four-page {
        width: 91%;
        height: 73%;
        background: #ffffff;
        margin: 13% auto 0;
        font-size: 1.4rem;
        display: none;
      }
      .four-page-clip {
        position: absolute;
        top: 6%;
        left: 20%;
        width: 60%;
        height: auto;
      }
      .four-page-left-hand {
        position: absolute;
        top: 12%;
        left: -5%;
        width: 20%;
        height: auto;
      }
      .four-page-right-hand {
        position: absolute;
        top: 12%;
        right: -5%;
        width: 20%;
        height: auto;
      }
      .four-page-title {
        padding-top: 12.5%;
        text-align: center;
        font-size: 1.5rem;
        font-weight: 600;
      }
      .four-page-title-second {
        margin-top: 5.5%;
        text-align: center;
      }
      .four-page-customer {
        margin: 4% 4% 0;
        /* border-bottom: 1px dotted #333333; */
        display: flex;
        justify-content: space-between;
      }
      .customer-item-name {
        display: inline-block;
        flex: 1.4;
      }
      .customer-item-department {
        display: inline-block;
        flex: 1.8;
      }
      .customer-item-clinic {
        display: inline-block;
        flex: 1;
        text-align: right;
      }
      .four-page-result {
        margin: 0.1rem 4% 0;
        padding-top: 8%;
        height: 45%;
        border-top: 1px dotted #333333;
        border-bottom: 1px dotted #333333;
      }
      .four-page-result-text {
        margin-top: 5%;
      }
      .four-page-sign {
        padding: 3% 4% 1%;
        display: flex;
        font-size: 1.2rem;
      }
      .four-page-sign-left {
        flex: 1;
      }
      .four-page-sign-left-img {
        width: 50%;
        height: auto;
      }
      .four-page-sign-right {
        flex: 1;
        position: relative;
      }
      .four-page-sign-right-img {
        width: 70%;
        height: auto;
        position: absolute;
        left: -0.5rem;
        top: 1rem;
      }
      .four-page-content-img {
        display: none;

      }
      p {
        line-height: 2rem;
      }
      @media screen and (max-width: 350px) {
        .four-page {
          height: 75%;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- 第一页 -->
      <div class="first-page">
        <input
          type="text"
          placeholder="请输入您的姓名"
          class="first-page-input"
        />
        <img
          src="./images/button.png"
          alt=""
          class="first-page-button"
          onclick="toInsure()"
        />
      </div>
      <div class="second-page">
        <p class="second-page-title"></p>
        <div class="second-page-content">
          <img src="./images/radio.png" class="content-img" />
          <span class="content-tip"></span>
        </div>
        <div class="second-page-content">
          <img src="./images/radio.png" class="content-img" />
          <span class="content-tip"></span>
        </div>
        <div class="second-page-content">
          <img src="./images/radio.png" class="content-img" />
          <span class="content-tip"></span>
        </div>
        <div class="second-page-content">
          <img src="./images/radio.png" class="content-img" />
          <span class="content-tip"></span>
        </div>
      </div>
      <div class="three-page">
        <svg
          style="width:100%;height:100%;"
          xmlns="http://www.w3.org/2000/svg"
          id="mySVG"
          viewBox="0 0 100% 100%"
          preserveAspectRatio="xMidYMid meet"
        >
          <image
            xlink:href="./images/sun.png"
            x="7%"
            y="5%"
            display="block"
            width="86%"
            height="50"
          >
            <animate
              attributeName="y"
              values="5%;70%;5%"
              begin="0s"
              dur="2s"
              repeatCount="indefinite"
            />
          </image>
        </svg>
      </div>

      <div class="four-page">
        <p class="four-page-title">春节假期综合症专科诊疗医院</p>
        <p class="four-page-title-second">诊断证明书</p>
        <div class="four-page-customer">
          <span class="customer-item-name">姓名</span>
          <span class="customer-item-department">科别：变态反应科</span>
          <span class="customer-item-clinic">门诊诊断</span>
        </div>
        <div class="four-page-result">
          <p>诊断及建议</p>
          <p>
            间歇性情绪不稳定；眼球不定时上翻难以控制，主要表现在不愿确认眼神，怼天怼地怼空气，一不小心就爆炸。
          </p>
          <p class="four-page-result-text">
            建议休息一周，以食物修身养性，避免影响节后工作。
          </p>
        </div>
        <div class="four-page-sign">
          <div class="four-page-sign-left">
            <img src="./images/qr_code.jpg" class="four-page-sign-left-img" />
          </div>
          <div class="four-page-sign-right">
            <p class="four-page-sign-date">日期：</p>
            <p>医师：Dr.Kaopu</p>
            <img
              src="./images/stamp.png"
              alt=""
              class="four-page-sign-right-img"
            />
          </div>
        </div>
      </div>
      <div class="four-page-content-img">
        <img src="./images/clip.png" class="four-page-clip" />
        <img src="./images/left_hand.png" class="four-page-left-hand" />
        <img src="./images/right_hand.png" class="four-page-right-hand" />
      </div>
    </div>
    <script>
      // 点击立即诊断
      var app = document.getElementById("app");
      var firstPage = document.getElementsByClassName("first-page")[0];
      var secondPage = document.getElementsByClassName("second-page")[0];
      var threePage = document.getElementsByClassName("three-page")[0];
      var fourPage = document.getElementsByClassName("four-page")[0];
      var fourPageImg = document.getElementsByClassName(
        "four-page-content-img"
      )[0];
      var firstPageInput = document.getElementsByClassName(
        "first-page-input"
      )[0];
      var secondPageTitle = document.getElementsByClassName(
        "second-page-title"
      )[0];
      var secondPageContents = document.getElementsByClassName(
        "second-page-content"
      );
      // var pageNum = 0 || sessionStorage.getItem("pageNum");
      var pageNum = 0; //当前是第几题
      var nameValue = null; //用户输入的名称
      function toInsure() {
        nameValue = firstPageInput.value;
        //判断是否已经输入了值
        if (!nameValue) {
          alert("请输入您的姓名");
        } else {
          //点击立即诊断，换背景图片隐藏首页的内容
          app.style.backgroundImage = "url('./images/background2.jpg')";
          firstPage.style.display = "none";
          secondPage.style.display = "block";
          sessionStorage.setItem("pageNum", pageNum);
          sessionStorage.setItem("nameValue", nameValue);
        }
        this.operateOption(pageNum);
      }
      //根据第几题展示内容
      function operateOption(num) {
        var that = this;
        var option = questionData.find(item => {
          return item.order == num;
        });
        secondPageTitle.innerHTML = option.title;
        option.options.forEach((item, index) => {
          var parentNode = secondPageContents[index];
          parentNode.children[1].innerHTML = item.value;
          parentNode.children[0].setAttribute("src", "./images/radio.png");
        });
        if (option.options.length < 4) {
          var parentNode = secondPageContents[3];
          parentNode.children[1].innerHTML = "";
          parentNode.children[0].setAttribute("src", "");
        }
        for (var i = 0; i < secondPageContents.length; i++) {
          let childValue = secondPageContents[i].children[1].innerText;
          if (childValue) {
            (function(i) {
              secondPageContents[i].onclick = function() {
                secondPageContents[i].children[0].setAttribute(
                  "src",
                  "./images/radio_checked.png"
                );
                if (num == "0") {
                  pageNum += 1;
                } else if (num == "1") {
                  // merrageCode = i;
                  //第二题判断是选择的那一道题
                  if (i == "0") {
                    pageNum = 8;
                    //选择已婚
                  } else if (i == "1" || i == "2") {
                    pageNum = 3;
                  } else {
                    //选择了管你屁事
                  }
                } else if (num == 8) {
                  if (i == "0") {
                    pageNum = 4;
                  } else if (i == "1") {
                    pageNum = 2;
                  } else {
                    //选择了管你屁事
                    this.dealNoCare();
                  }
                } else if (num == 4) {
                  if (i == 2) {
                    //选择了管你屁事
                    this.dealNoCare();
                  } else {
                    pageNum = 2;
                  }
                } else if (num == 2) {
                  if (i == 2) {
                    //选择了管你屁事
                    this.dealNoCare();
                  } else {
                    pageNum = 5;
                  }
                } else if (num == 3) {
                  if (i == 0) {
                    pageNum = 6;
                  } else if (i == 1 || i == 2) {
                    pageNum = 5;
                  }
                } else if (num == 6) {
                  if (i == 2) {
                    //选择了管你屁事
                    this.dealNoCare();
                  } else {
                    pageNum = 7;
                  }
                } else if (num == 7) {
                  pageNum = 5;
                } else if (num == 5) {
                  //最后一题进入loading页面
                  that.dealResult();
                }
                if (num != 5) {
                  setTimeout(function() {
                    return operateOption(pageNum);
                  }, 400);
                }
              };
            })(i);
          }
        }
      }
      //处理关你屁事的选项
      function dealNoCare() {}
      //最后结果页
      function dealResult() {
        var customerName = document.getElementsByClassName(
          "customer-item-name"
        )[0];
        var signDate = document.getElementsByClassName(
          "four-page-sign-date"
        )[0];
        // // 首先进入loading页面
        //     app.style.backgroundImage = "url('./images/background3.jpg')";
        secondPage.style.display = "none";
        //   threePage.style.display = "block";

        app.style.backgroundImage = "url('./images/background4.jpg')";
        threePage.style.display = "none";
        fourPage.style.display = "block";
        customerName.innerHTML = "姓名：" + nameValue;
        signDate.innerHTML = "日期：" + this.getNowDate();
        fourPageImg.style.display = "block";

        //loading页面显示2秒后进入结果页面
        // setTimeout(function() {
        //                 }, 2000);
      }
      function getNowDate() {
        var now = new Date();
        var year = now.getFullYear(); //年
        var month = now.getMonth() + 1; //月
        var day = now.getDate(); //日
        var clock = year + "年";
        if (month < 10) {
          clock += "0";
        }
        clock += month + "月";
        if (day < 10) {
          clock += "0";
        }
        clock += day + "日";
        return clock;
      }
    </script>
  </body>
</html>
